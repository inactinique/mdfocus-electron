# Guide for Using Word Templates (.dotx)

## Overview

ClioDesk supports using custom Word templates (.dotx files) for document export. This feature allows you to apply your own formatting, styles, and structure to your Word exports.

## Basic Usage

### 1. Automatic Detection

To use a Word template, simply place a `.dotx` file in your ClioDesk project folder:

```
my_project/
├── .cliodesk/
├── document.md
├── bibliography.bib
└── my_template.dotx  ← Your Word template
```

ClioDesk will automatically detect the template and inform you during export.

### 2. Export with Template

When exporting to Word:
1. Open the **Project** panel
2. Click **Export Word (.docx)**
3. If a template is detected, you'll see a message: **Word template detected: my_template.dotx**
4. Fill in the information (title, author)
5. Click **Export**

The generated document will use the styles and formatting from your template.

## Creating a Template with Placeholders

ClioDesk uses `docxtemplater` to merge your content with the template. You can create a template with placeholders for precise control:

### Available Placeholders

| Placeholder | Description | Example |
|-------------|-------------|---------|
| `{title}` | Document title | "My Scientific Article" |
| `{author}` | Document author | "John Smith" |
| `{date}` | Export date | "01/11/2026" |
| `{content}` | Converted Markdown content | Your entire document.md |
| `{abstract}` | Abstract (if abstract.md file exists) | Your summary |

### Template Example

Create a Word document and insert these placeholders:

```
═══════════════════════════════════════════════════
                    {title}

                 By {author}
                    {date}
═══════════════════════════════════════════════════

ABSTRACT

{abstract}


CONTENT

{content}
```

Save this document as `.dotx` format (File → Save As → Word Template).

## Styles and Formatting

### Automatic Styles

If your template contains named styles, ClioDesk will automatically apply them:

- **Heading 1** → `Heading1` or `Titre 1`
- **Heading 2** → `Heading2` or `Titre 2`
- **Heading 3** → `Heading3` or `Titre 3`
- **Normal** → Default paragraph style
- **Quote** → Citations and blockquotes

### Headers and Footers

Your template can include:
- Custom headers
- Custom footers
- Page numbering
- Institutional logo or image

**Note**: If your template doesn't have headers/footers, ClioDesk will use defaults (title in header, page number in footer).

## Error Handling Behavior

If the template cannot be loaded (corrupted file, incorrect placeholders, etc.), ClioDesk will:
1. Display a warning in logs
2. Automatically fall back to standard generation
3. Still create your document (without applying the template)

You'll never lose your export!

## Use Cases

### University Theses and Dissertations

Create a template with:
- Institutional title page
- Declaration of honor
- Table of contents (generated by Word)
- Heading styles conforming to requirements

### Scientific Articles

Use a template respecting:
- Specific journal format (APA, Vancouver, etc.)
- Required margins and spacing
- Header with running title

### Professional Reports

Include in your template:
- Company logo
- Brand guidelines
- Footer with legal information

## Advanced Settings

### Multiple Templates

If you have multiple `.dotx` files in your project, ClioDesk will use the **first found** (alphabetical order).

**Recommendation**: Use only one template per project.

### Templates by Project Type

You can create specific templates based on project type:

```
templates/
├── article_template.dotx  ← For articles
├── book_template.dotx     ← For books
└── notes_template.dotx    ← For notes
```

Copy the appropriate template to your project before export.

## Troubleshooting

### Template Not Detected

- Verify the file has `.dotx` extension (not `.docx`)
- Make sure the file is in the project **root folder** (not in `.cliodesk/`)
- Restart ClioDesk if necessary

### Content Doesn't Appear

If using placeholders:
- Check spelling: `{content}` not `{contenu}`
- Use single braces, not double
- No spaces: `{title}` not `{ title }`

### Incorrect Formatting

- Verify your Word styles are properly named (Heading 1, Heading 2, etc.)
- Test the template by manually creating a Word document
- Make sure the template isn't corrupted

## Resources

- [docxtemplater Documentation](https://docxtemplater.com/)
- [Creating a Word Template - Microsoft](https://support.microsoft.com/en-us/office/create-a-template-86a1d089-5ae2-4d53-9042-1191bce57deb)

## Support

If you encounter issues:
1. Check ClioDesk logs (Journal Panel)
2. Verify your template opens correctly in Word
3. Try exporting without a template to confirm the issue is with the template

---

**Version**: 1.0.0
**Last updated**: January 2026
